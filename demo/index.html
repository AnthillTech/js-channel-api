<!DOCTYPE html>
<html>
    <head>
        <title>Event server client API sandbox</title>
        <link rel="stylesheet" media="screen" href="assets/main.css">
        <script src="assets/jquery-1.9.0.min.js" type="text/javascript"></script>
        <script src="../src/client-api.js" type="text/javascript"></script>
    </head>
    <body>
        

    <h1>Event server Client API sandbox</h1>
 
    <div id="chatLog"></div>
 
    <div>Message: <input id="text" type="text"/></div>
 
    <script>
    
    $(document).ready(function() {
     
        var url = "ws://vps77209.ovh.net:9000/ws";
        //var url = "ws://localhost:9000/ws";
        var channelName = "channel1";
        var deviceName = "testApi";
        var password = "pass";
        var connection = channelConnect(url, channelName, deviceName, password);

        connection.onConnected = function(){
        	message("Connected");
        }
        connection.onError = function(reason){
            message("Error: " + reason);
        }
        
        connection.onEvent = function(id, content){
        	message("Received id: " + id + " content:" + content);
        }
     
        function message(msg){
            $('#chatLog').append("<p class='event'>" + msg + "</p>");
        }
        
        $('#text').keypress(function(event) {
            if (event.keyCode == '13') {
                sendEvent();
            }
        });
        
        function sendEvent(){
             
            var text = $('#text').val();
            if(text==""){
                message("Please enter a message");
            }
            else{
                message("Sending: " + text);
                connection.sendToChannel("/test/1", text);
                $('#text').val("");
            }
        }
    });
    
    </script>   

    </body>
</html>
